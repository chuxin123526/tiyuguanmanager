<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<!-- 配置开发模式 -->
	<constant name="struts.devMode" value="true" />

	<!-- 系统基础包 -->
	<package name="base-package" extends="json-default">
		<interceptors>
			<interceptor name="auth" class="authenticationInterceptor" />
			<interceptor-stack name="authenticationInterceptor">
				<interceptor-ref name="defaultStack" />
				<interceptor-ref name="auth" />
			</interceptor-stack>
		</interceptors>

		<global-results>
			<result name="login" type="redirect">/user/loginPage</result>
			<result name="permission_denied">/WEB-INF/jsp/user/common/denied.jsp</result>

			<!-- 用于相应 ajax 请求，使用 json 返回值 -->
			<result name="json" type="json">
				<param name="root">ajaxReturn</param>
			</result>
		</global-results>
	</package>


	<!-- 系统首页 -->
	<package name="default" extends="base-package">
		<action name="index" class="indexPageAction" method="homePage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">1</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/index.jsp</result>
		</action>
	</package>

	<!-- 用户管理模块 -->
	<package name="userModule" extends="base-package" namespace="/user">

		<global-results>
			<result name="error">/WEB-INF/jsp/user/common/error.jsp</result>
		</global-results>

		<!-- ajax 登录 -->
		<action name="login" class="userAction" method="login">
			<!-- 采用全局 -->
		</action>

		<!-- ajax 注销 -->
		<action name="logout" class="userAction" method="logout">
			<!-- 采用全局 -->
		</action>

		<!-- 登录页面 -->
		<action name="loginPage" class="pageAction" method="loginPage">
			<result name="success">/WEB-INF/jsp/user/login.jsp</result>
			<result name="toIndex" type="redirect">/index</result>
		</action>

		<!-- 注销页面 -->
		<action name="logoutPage" class="userAction" method="logoutPage">
			<result name="success" type="redirect">loginPage</result>
		</action>

		<!-- 注册页面 -->
		<action name="registerPage" class="pageAction" method="registerPage">
			<result name="success">/WEB-INF/jsp/user/register.jsp</result>
		</action>

		<!-- ajax 处理注册的 Action -->
		<action name="register" class="userAction" method="register">
			<!-- 采用全局 -->
		</action>

		<!-- 用户管理的首页 -->
		<action name="adminIndex" class="userAdminAction" method="index">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">10,11,12,13,14,20,21,22,23</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/index.jsp</result>
		</action>

		<!-- 角色列表页面 -->
		<action name="roleList" class="roleAdminAction" method="roleList">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">21,22,23</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/role/roleList.jsp
			</result>
		</action>

		<!-- 创建新角色页面 -->
		<action name="insertRolePage" class="roleAdminAction" method="insertRolePage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">20</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/role/roleDetailed.jsp
			</result>
		</action>

		<!-- 真正处理角色添加的方法 -->
		<action name="insertRole" class="roleAdminAction" method="insertRole">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">20</param>
				<param name="auth.ajaxAction">true</param>
			</interceptor-ref>
		</action>

		<!-- 处理删除角色的 action -->
		<action name="deleteRole" class="roleAdminAction" method="deleteRole">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">21</param>
				<param name="auth.ajaxAction">true</param>
			</interceptor-ref>
		</action>

		<!-- 变更角色页面 -->
		<action name="updateRolePage" class="roleAdminAction" method="updateRolePage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">23</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/role/roleDetailed.jsp
			</result>
		</action>

		<!-- 处理角色变更请求 -->
		<action name="updateRole" class="roleAdminAction" method="updateRole">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">23</param>
				<param name="auth.ajaxAction">true</param>
			</interceptor-ref>
		</action>

		<!-- 角色查询 -->
		<action name="roleQueryPage" class="roleAdminAction" method="roleQueryPage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">22</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/role/roleQuery.jsp
			</result>
		</action>

		<!-- 角色查询响应处理 -->
		<action name="roleQuery" class="roleAdminAction" method="roleQuery">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">22</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/role/roleList.jsp
			</result>
		</action>

		<!-- 创建用户的页面 -->
		<action name="newUserPage" class="userAdminAction" method="newUserPage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">10</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/user/newUser.jsp</result>
		</action>

		<!-- 处理用户创建请求的表单 -->
		<action name="newUser" class="userAdminAction" method="newUser">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">10</param>
				<param name="auth.ajaxAction">true</param>
			</interceptor-ref>
		</action>

		<!-- 用户查询页面 -->
		<action name="userQueryPage" class="userAdminAction" method="userQueryPage">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">14</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/user/queryUser.jsp
			</result>
		</action>

		<!-- 处理用户查询的方法 -->
		<action name="userQuery" class="userAdminAction" method="userQuery">
			<interceptor-ref name="authenticationInterceptor">
				<param name="auth.permission">14</param>
			</interceptor-ref>
			<result name="success">/WEB-INF/jsp/user/admin/user/queryResult.jsp
			</result>
		</action>
	</package>

	<package name="somebody" extends="struts-default" namespace="/competition">
		<!-- 全局跳转配置 -->
		<global-results>
			<result name="error">/WEB-INF/jsp/competition/common/error.jsp
			</result>
		</global-results>

		<!-- 赛事首页配置 -->
		<action name="competitionHomeAction_*" class="competitionHomeAction"
			method="{1}">
			<result name="index">/WEB-INF/jsp/competition/home/index.jsp</result>
			<result name="admin_index">/WEB-INF/jsp/competition/admin/admin_index.jsp
			</result>
		</action>
		<!-- 赛事新闻配置 -->
		<action name="competitionNewsAction_*" class="competitionNewsAction"
			method="{1}">
			<result name="index">/WEB-INF/jsp/competition/competitionNews/index.jsp
			</result>
			<result name="news">/WEB-INF/jsp/competition/competitionNews/news.jsp
			</result>
			<result name="newsList">/WEB-INF/jsp/competition/competitionNews/newsList.jsp
			</result>
		</action>
		<!-- 测试用户配置 -->
		<action name="competitionUserAction_*" class="competitionUserAction"
			method="{1}">
			<result name="toCompetitionIndex">/WEB-INF/jsp/competition/home/index.jsp</result>
			<result name="userNotFound">/index.jsp</result>
		</action>
		<!-- 赛事配置 -->
		<action name="competitionAction_*" class="competitionAction"
			method="{1}">
			<result name="index">/WEB-INF/jsp/competition/competition/index.jsp
			</result>
			<result name="applyUI">/WEB-INF/jsp/competition/competition/applyUI.jsp
			</result>
			<result name="toApplying" type="redirect">competitionAction_applying
			</result>
			<result name="applying">/WEB-INF/jsp/competition/competition/applying.jsp
			</result>
			<result name="unStart">/WEB-INF/jsp/competition/competition/unStart.jsp
			</result>
			<result name="ongoing">/WEB-INF/jsp/competition/competition/ongoing.jsp
			</result>
			<result name="end">/WEB-INF/jsp/competition/competition/end.jsp
			</result>

		</action>
		<!-- 后台—赛事首页配置 -->
		<action name="competitionManagerHomeAction_*" class="competitionManagerHomeAction"
			method="{1}">
			<result name="index">/WEB-INF/jsp/competition/admin/home/index.jsp
			</result>
		</action>
		<!-- 后台—赛事管理配置 -->
		<action name="competitionManagerAction_*" class="competitionManagerAction"
			method="{1}">
			<result name="list">/WEB-INF/jsp/competition/admin/competition/competitionList.jsp
			</result>
			<result name="approveUI">/WEB-INF/jsp/competition/admin/competition/approveUI.jsp
			</result>
			<result name="toList" type="redirect">competitionManagerAction_list
			</result>
		</action>
		<!-- 后台—赛事新闻管理配置 -->
		<action name="competitionNewsManagerAction_*" class="competitionNewsManagerAction"
			method="{1}">
			<result name="toList" type="redirect">competitionNewsManagerAction_list
			</result>
			<result name="list">/WEB-INF/jsp/competition/admin/competitionNews/list.jsp
			</result>
			<result name="addUI">/WEB-INF/jsp/competition/admin/competitionNews/addUI.jsp
			</result>
		</action>
	</package>
</struts>